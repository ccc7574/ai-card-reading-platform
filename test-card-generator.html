<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•å¡ç‰‡ç”Ÿæˆå™¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-button {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        .test-button:hover {
            opacity: 0.9;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
        }
        .close-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            float: right;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª å¡ç‰‡ç”Ÿæˆå™¨åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="status">
        <h3>æµ‹è¯•çŠ¶æ€</h3>
        <div id="test-status">å‡†å¤‡æµ‹è¯•...</div>
    </div>

    <h2>1. åŸºç¡€æŒ‰é’®æµ‹è¯•</h2>
    <button class="test-button" onclick="testBasicClick()">
        â• æµ‹è¯•åŸºç¡€ç‚¹å‡»
    </button>

    <h2>2. æ¨¡æ‹Ÿå¡ç‰‡ç”Ÿæˆå™¨</h2>
    <button class="test-button" onclick="openModal()">
        ğŸš€ æ‰“å¼€ç”Ÿæˆå™¨æ¨¡æ€æ¡†
    </button>

    <h2>3. APIè¿æ¥æµ‹è¯•</h2>
    <button class="test-button" onclick="testAPI()">
        ğŸ”— æµ‹è¯•APIè¿æ¥
    </button>

    <h2>4. å®é™…é¡µé¢æµ‹è¯•</h2>
    <button class="test-button" onclick="testRealPage()">
        ğŸŒ åœ¨æ–°çª—å£æ‰“å¼€å®é™…é¡µé¢
    </button>

    <!-- æ¨¡æ€æ¡† -->
    <div id="modal" style="display: none;" class="modal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">å…³é—­</button>
            <h3>ğŸ¨ AIå¡ç‰‡ç”Ÿæˆå™¨</h3>
            <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¨¡æ€æ¡†ï¼Œæ¨¡æ‹Ÿå¡ç‰‡ç”Ÿæˆå™¨çš„è¡Œä¸ºã€‚</p>
            
            <div style="margin: 20px 0;">
                <label>æ–‡ç« é“¾æ¥:</label><br>
                <input type="url" placeholder="è¾“å…¥æ–‡ç« é“¾æ¥..." style="width: 100%; padding: 8px; margin: 5px 0;">
            </div>
            
            <div style="margin: 20px 0;">
                <label>AIæ¡†æ¶:</label><br>
                <select style="width: 100%; padding: 8px; margin: 5px 0;">
                    <option>V1 - ç»å…¸æ¡†æ¶</option>
                    <option>V2 - LangChain</option>
                    <option selected>V3 - æ™ºèƒ½åä½œ</option>
                </select>
            </div>
            
            <button class="test-button" onclick="simulateGeneration()">
                âœ¨ å¼€å§‹ç”Ÿæˆ
            </button>
        </div>
    </div>

    <script>
        let testResults = [];

        function updateStatus(message) {
            document.getElementById('test-status').innerHTML = message;
            console.log('æµ‹è¯•çŠ¶æ€:', message);
        }

        function testBasicClick() {
            updateStatus('âœ… åŸºç¡€ç‚¹å‡»åŠŸèƒ½æ­£å¸¸');
            testResults.push('åŸºç¡€ç‚¹å‡»: é€šè¿‡');
        }

        function openModal() {
            document.getElementById('modal').style.display = 'flex';
            updateStatus('âœ… æ¨¡æ€æ¡†æ‰“å¼€æˆåŠŸ');
            testResults.push('æ¨¡æ€æ¡†: é€šè¿‡');
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            updateStatus('âœ… æ¨¡æ€æ¡†å…³é—­æˆåŠŸ');
        }

        function simulateGeneration() {
            updateStatus('ğŸ”„ æ¨¡æ‹Ÿç”Ÿæˆä¸­...');
            setTimeout(() => {
                updateStatus('âœ… æ¨¡æ‹Ÿç”Ÿæˆå®Œæˆ');
                testResults.push('ç”Ÿæˆæ¨¡æ‹Ÿ: é€šè¿‡');
                closeModal();
            }, 2000);
        }

        async function testAPI() {
            updateStatus('ğŸ”„ æµ‹è¯•APIè¿æ¥...');
            try {
                const response = await fetch('http://localhost:3000/api/data-sources?action=status');
                if (response.ok) {
                    const data = await response.json();
                    updateStatus(`âœ… APIè¿æ¥æˆåŠŸ: ${data.data.active}/${data.data.total} æ•°æ®æºæ´»è·ƒ`);
                    testResults.push('APIè¿æ¥: é€šè¿‡');
                } else {
                    updateStatus('âŒ APIè¿æ¥å¤±è´¥: ' + response.status);
                    testResults.push('APIè¿æ¥: å¤±è´¥');
                }
            } catch (error) {
                updateStatus('âŒ APIè¿æ¥é”™è¯¯: ' + error.message);
                testResults.push('APIè¿æ¥: é”™è¯¯');
            }
        }

        function testRealPage() {
            window.open('http://localhost:3000', '_blank');
            updateStatus('ğŸŒ å·²åœ¨æ–°çª—å£æ‰“å¼€å®é™…é¡µé¢ï¼Œè¯·æ‰‹åŠ¨æµ‹è¯•ç”Ÿæˆå™¨æŒ‰é’®');
            testResults.push('é¡µé¢æ‰“å¼€: é€šè¿‡');
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.onload = function() {
            updateStatus('ğŸš€ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•');
            
            // è‡ªåŠ¨æµ‹è¯•APIè¿æ¥
            setTimeout(testAPI, 1000);
        };

        // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
        function showResults() {
            const results = testResults.join('\n');
            alert('æµ‹è¯•ç»“æœ:\n' + results);
        }

        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
            if (e.ctrlKey && e.key === 'r') {
                e.preventDefault();
                showResults();
            }
        });
    </script>

    <div style="margin-top: 40px; padding: 20px; background: #f9fafb; border-radius: 8px;">
        <h3>ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
        <p><strong>æµ‹è¯•ç›®çš„:</strong> éªŒè¯å¡ç‰‡ç”Ÿæˆå™¨çš„ç‚¹å‡»å’Œæ¨¡æ€æ¡†åŠŸèƒ½</p>
        <p><strong>å¿«æ·é”®:</strong> ESC - å…³é—­æ¨¡æ€æ¡†, Ctrl+R - æ˜¾ç¤ºæµ‹è¯•ç»“æœ</p>
        <p><strong>é¢„æœŸè¡Œä¸º:</strong> ç‚¹å‡»æŒ‰é’®åº”è¯¥æ‰“å¼€ç”Ÿæˆå™¨æ¨¡æ€æ¡†</p>
        <button class="test-button" onclick="showResults()">ğŸ“Š æ˜¾ç¤ºæµ‹è¯•ç»“æœ</button>
    </div>
</body>
</html>
